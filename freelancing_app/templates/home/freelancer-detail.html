{% extends "base.html" %}
{% load static %}
{% load number_filters %}
{% load custom_filters %}
{% load project_filters %}

{% block title %}{{freelancer.user.full_name}} - HireMe{% endblock %}

{% block css_files %}
<link rel="stylesheet" href="{% static 'css/home/freelancer-detail.css' %}">
{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="hero-section">
    <div class="container">
        <div class="hero-content">            
            <div class="profile-header">
                <div class="profile-avatar">
                    {% if freelancer.user.profile_image %}
                        <img src="{% get_media_prefix %}profile_images/{{ freelancer.user.profile_image }}" alt="Profile Picture" class="freelancer-profile-img">
                    {% else %}
                        <div class="profile-icon">
                            <i class="fas fa-user"></i>
                        </div>
                    {% endif %}
                    {% if freelancer.badge == 'rising_talent' %}
                        <div class="freelancer-badge rising-talent" title="Rising Talent">
                            <i class="fas fa-seedling"></i>
                        </div>
                    {% elif freelancer.badge == 'top_rated' %}
                        <div class="freelancer-badge top-rated" title="Top Rated">
                            <i class="fas fa-star"></i>
                        </div>
                    {% elif freelancer.badge == 'pro_verified' %}
                        <div class="freelancer-badge pro-verified" title="Pro Verified">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    {% endif %}
                </div>
                
                <div class="profile-info">
                    <div class="name-and-badge">
                        <h2 class="freelancer-name">{{freelancer.user.full_name}}</h2>
                        {% if freelancer.is_featured %}
                            <span class="featured-star" title="Featured Freelancer"><i class="fas fa-star"></i> Featured</span>
                        {% endif %}
                    </div>
                    <h2 class="professional-title">{{freelancer.professional_title}}</h2>

                    <div class="meta-info">
                        <div class="meta-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>{{freelancer.user.city|default:"N/A"}}</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-briefcase"></i>
                            <span>{{freelancer.years_of_experience|default:"N/A"}} years experience</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-clock"></i>
                            <span>{{freelancer.availability|default:"N/A"}}</span>
                        </div>
                    </div>

                    <div class="rating-section">
                        <div class="stars">
                            <span class="filled">★★★★★</span>
                            <span class="rating-value">4.9</span>
                            <span class="reviews-count">(128 reviews)</span>
                        </div>
                    </div>

                    <div class="action-buttons">
                        {% if user.is_authenticated %}
                            <a href="" class="btn btn-primary">
                                <i class="fas fa-paper-plane"></i> Invite to Job
                            </a>
                        {% else %}
                            <a href="{% url 'account:login' %}" class="btn btn-primary">
                                <i class="fas fa-paper-plane"></i> Invite to Job
                            </a>
                        {% endif %}
                        {% if user.is_authenticated %}
                            <a href="#" class="btn btn-secondary" onclick="startChatWithFreelancer({{ freelancer.user.id }})">
                                <i class="fas fa-envelope"></i> Send Message
                            </a>
                        {% endif %}
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<!-- Freelancer Overview Section -->
<div class="overview-section">
    <div class="container">
        <div class="overview-grid">

            <div class="overview-main">
                
                <div class="section-card">
                    <h3 class="section-title">
                        <i class="fas fa-user"></i> About {{freelancer.user.full_name}}
                    </h3>
                    <div class="about-content">
                        <p>{{freelancer.user.bio|default:"N/A"}}</p>
                    </div>
                </div>

                <div class="section-card skills-card">
                    <div class="skills-header">
                        <h3 class="section-title">
                            <i class="fas fa-code"></i> Professional Skills
                        </h3>
                        <div class="skills-counter">
                            <span class="counter-number">{{freelancer.skills.count}}</span>
                            <span class="counter-text">Skills</span>
                        </div>
                    </div>
                    <div class="skills-list">
                        {% for freelancer_skill in freelancer.freelancerskill_set.all %}
                            <div class="skill-tag" data-skill-level="{{ freelancer_skill.level }}">
                                <i class="fas fa-code"></i> {{ freelancer_skill.skill.name }}
                                <span class="skill-level-badge">{{ freelancer_skill.get_level_display }}</span>
                            </div>
                        {% endfor %}
                    </div>
                </div>
                <div class="section-card">
                    <h3 class="section-title">
                        <i class="fas fa-hands-helping"></i> Services I Offer
                    </h3>
                    <div class="services-list">
                        {% for category in service_categories %}
                            <div class="service-item">
                                <div class="service-icon">
                                    {% if category.icon_class %}
                                        <i class="{{ category.icon_class }}"></i>
                                    {% else %}
                                        <i class="fas fa-code"></i>
                                    {% endif %}
                                </div>
                                <div class="service-content">
                                    <h4 class="service-title">{{ category.name }}</h4>
                                    {% if category.description %}
                                        <p class="service-description">{{ category.description }}</p>
                                    {% endif %}
                                </div>
                            </div>
                        {% empty %}
                            <div class="no-services">
                                <p>No services available yet.</p>
                            </div>
                        {% endfor %}
                    </div>
                </div>
                <div class="section-card">
                    <h3 class="section-title">
                        <i class="fas fa-briefcase"></i> Work Experience
                    </h3>
                    <div class="experience-container">
                        <div class="experience-timeline">
                            {% for experience in experiences %}
                                <div class="experience-item">
                                    <div class="experience-header">
                                        <h4 class="experience-title">{{ experience.job_title }}</h4>
                                        <p class="experience-company">{{ experience.company_name }}</p>
                                        <div class="experience-meta">
                                            <div class="experience-meta-item">
                                                <i class="fas fa-calendar-alt"></i>
                                                <span>
                                                    {{ experience.start_date|date:"M Y" }} - 
                                                    {% if experience.currently_working %}
                                                        Present
                                                    {% else %}
                                                        {{ experience.end_date|date:"M Y" }}
                                                    {% endif %}
                                                </span>
                                            </div>
                                            {% if experience.city %}
                                                <div class="experience-meta-item">
                                                    <i class="fas fa-map-marker-alt"></i>
                                                    <span>{{ experience.city.name }}, {{ experience.country.name }}</span>
                                                </div>
                                            {% endif %}
                                            <div class="experience-meta-item">
                                                <i class="fas fa-briefcase"></i>
                                                <span>{{ experience.get_employment_type_display }}</span>
                                            </div>
                                        </div>
                                    </div>
                                    {% if experience.description %}
                                        <div class="experience-description">
                                            <p>{{ experience.description }}</p>
                                        </div>
                                    {% endif %}
                                    {% if experience.skills.all %}
                                        <div class="experience-skills">
                                            {% for skill in experience.skills.all %}
                                                <span class="experience-skill">{{ skill.name }}</span>
                                            {% endfor %}
                                        </div>
                                    {% endif %}
                                </div>
                            {% empty %}
                                <div class="no-experience">
                                    <p>No work experience available yet.</p>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <div class="section-card">
                    <h3 class="section-title">
                        <i class="fas fa-graduation-cap"></i> Education
                    </h3>
                    <div class="education-container">
                        <div class="education-timeline">
                            {% for education in educations %}
                                <div class="education-item">
                                    <div class="education-header">
                                        <h4 class="education-degree">{{ education.get_degree_display }}</h4>
                                        <p class="education-school">{{ education.institution }}</p>
                                        <div class="education-meta">
                                            <div class="education-meta-item">
                                                <i class="fas fa-calendar-alt"></i>
                                                <span>
                                                    {{ education.start_date|date:"M Y" }} - 
                                                    {% if education.currently_studying %}
                                                        Present
                                                    {% else %}
                                                        {{ education.end_date|date:"M Y" }}
                                                    {% endif %}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    {% if education.gpa %}
                                        <div class="education-gpa">
                                            <i class="fas fa-award"></i> GPA: {{ education.gpa }}/4.0
                                        </div>
                                    {% endif %}
                                </div>
                            {% empty %}
                                <div class="no-education">
                                    <p>No education records available yet.</p>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <div class="section-card">
                    <h3 class="section-title">
                        <i class="fas fa-language"></i> Languages
                    </h3>
                    <div class="languages-list">
                        {% for lang in freelancer_languages %}
                        <div class="language-item">
                            <div class="language-header">
                                <span class="language-name">{{ lang.language.name }}</span>
                                <span class="language-level">{{ lang.get_proficiency_display }}</span>
                            </div>
                            <div class="language-bar">
                                <div class="language-progress" style="width: {{ lang.proficiency|multiply:20 }}%"></div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                <div class="section-card">
                    <h3 class="section-title">
                        <i class="fas fa-star"></i> Reviews & Ratings
                    </h3>
                    <div class="reviews-header">
                        <div class="reviews-count">128 reviews</div>
                        <div class="reviews-filter">
                            <div class="filter-item active">All</div>
                            <div class="filter-item">Recent</div>
                            <div class="filter-item">Positive</div>
                            <div class="filter-item">Critical</div>
                        </div>
                    </div>
                    <div class="reviews-stats">
                        <div class="review-overall">
                            <div class="review-score">4.9</div>
                            <div class="review-stars">★★★★★</div>
                            <div class="review-count">out of 5</div>
                        </div>
                        <div class="review-bars">
                            <div class="review-bar-item">
                                <div class="review-bar-label">5</div>
                                <div class="review-bar-track">
                                    <div class="review-bar-progress" style="width: 92%"></div>
                                </div>
                                <div class="review-bar-count">112</div>
                            </div>
                            <div class="review-bar-item">
                                <div class="review-bar-label">4</div>
                                <div class="review-bar-track">
                                    <div class="review-bar-progress" style="width: 8%"></div>
                                </div>
                                <div class="review-bar-count">10</div>
                            </div>
                            <div class="review-bar-item">
                                <div class="review-bar-label">3</div>
                                <div class="review-bar-track">
                                    <div class="review-bar-progress" style="width: 4%"></div>
                                </div>
                                <div class="review-bar-count">5</div>
                            </div>
                            <div class="review-bar-item">
                                <div class="review-bar-label">2</div>
                                <div class="review-bar-track">
                                    <div class="review-bar-progress" style="width: 1%"></div>
                                </div>
                                <div class="review-bar-count">1</div>
                            </div>
                            <div class="review-bar-item">
                                <div class="review-bar-label">1</div>
                                <div class="review-bar-track">
                                    <div class="review-bar-progress" style="width: 0%"></div>
                                </div>
                                <div class="review-bar-count">0</div>
                            </div>
                        </div>
                    </div>
                    <div class="reviews-list">
                        <div class="review-item">
                            <div class="review-header">
                                <div class="reviewer-info">
                                    <div class="reviewer-avatar">
                                        <img src="https://randomuser.me/api/portraits/women/28.jpg" alt="Sarah Johnson">
                                    </div>
                                    <div class="reviewer-meta">
                                        <div class="reviewer-name">Sarah Johnson</div>
                                        <div class="reviewer-project">E-commerce Platform Development</div>
                                    </div>
                                </div>
                                <div class="review-rating">
                                    <div class="review-stars">★★★★★</div>
                                    <div class="review-date">2 weeks ago</div>
                                </div>
                            </div>
                            <div class="review-comment">
                                <p>John is an exceptional developer. He completely transformed our e-commerce platform, making it faster, more user-friendly, and significantly more secure. His attention to detail and problem-solving skills are remarkable. He communicated clearly throughout the project and delivered ahead of schedule. Would definitely work with him again!</p>
                            </div>
                        </div>
                        <div class="review-item">
                            <div class="review-header">
                                <div class="reviewer-info">
                                    <div class="reviewer-avatar">
                                        <img src="https://randomuser.me/api/portraits/men/45.jpg" alt="Michael Chen">
                                    </div>
                                    <div class="reviewer-meta">
                                        <div class="reviewer-name">Michael Chen</div>
                                        <div class="reviewer-project">Payment System Integration</div>
                                    </div>
                                </div>
                                <div class="review-rating">
                                    <div class="review-stars">★★★★★</div>
                                    <div class="review-date">1 month ago</div>
                                </div>
                            </div>
                            <div class="review-comment">
                                <p>We hired John to integrate a complex payment system into our application. He not only delivered exactly what we needed but also suggested several improvements that have significantly reduced our transaction failures. His documentation was thorough and made it easy for our team to maintain the system going forward.</p>
                            </div>
                        </div>
                        <div class="review-item">
                            <div class="review-header">
                                <div class="reviewer-info">
                                    <div class="reviewer-avatar">
                                        <img src="https://randomuser.me/api/portraits/women/63.jpg" alt="Jennifer Williams">
                                    </div>
                                    <div class="reviewer-meta">
                                        <div class="reviewer-name">Jennifer Williams</div>
                                        <div class="reviewer-project">Dashboard & Analytics Development</div>
                                    </div>
                                </div>
                                <div class="review-rating">
                                    <div class="review-stars">★★★★★</div>
                                    <div class="review-date">2 months ago</div>
                                </div>
                            </div>
                            <div class="review-comment">
                                <p>John built us a custom analytics dashboard that has transformed how we make business decisions. He took the time to understand our specific needs and delivered a solution that was both powerful and user-friendly. The data visualizations he created are intuitive and have helped us identify several opportunities for growth. Highly recommended!</p>
                            </div>
                        </div>
                    </div>
                    <div class="review-pagination">
                        <div class="pagination-item">
                            <i class="fas fa-chevron-left"></i>
                        </div>
                        <div class="pagination-item active">1</div>
                        <div class="pagination-item">2</div>
                        <div class="pagination-item">3</div>
                        <div class="pagination-item">...</div>
                        <div class="pagination-item">12</div>
                        <div class="pagination-item">
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="overview-sidebar">
                <div class="sidebar-card">
                    <h3 class="card-title">
                        <i class="fas fa-chart-line"></i> Profile Stats
                    </h3>
                    <div class="profile-stats">
                        <div class="stat-item">
                            <div class="stat-value">128</div>
                            <div class="stat-label">Completed Projects</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">4.9</div>
                            <div class="stat-label">Average Rating</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">{{freelancer.years_of_experience|default:"N/A"}}+</div>
                            <div class="stat-label">Years Experience</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">98%</div>
                            <div class="stat-label">On-time Delivery</div>
                        </div>
                    </div>
                </div>

                <div class="sidebar-card">
                    <h3 class="card-title">
                        <i class="fas fa-id-card"></i> Professional Info
                    </h3>
                    <div class="profile-info-list">
                        <div class="info-item">
                            <div class="info-icon">
                                <i class="fas fa-medal"></i>
                            </div>
                            <div class="info-content">
                                <div class="info-label">Expertise Level</div>
                                <div class="info-value">{{freelancer.expertise_level|default:"N/A"}}</div>
                            </div>
                        </div>
                        <div class="info-item">
                            <div class="info-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="info-content">
                                <div class="info-label">Availability</div>
                                <div class="info-value">{{freelancer.availability|default:"N/A"}}</div>
                            </div>
                        </div>
                        <div class="info-item">
                            <div class="info-icon">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <div class="info-content">
                                <div class="info-label">Preferred Project Duration</div>
                                <div class="info-value">{{freelancer.preferred_project_duration|default:"N/A"}}</div>
                            </div>
                        </div>
                        <div class="info-item">
                            <div class="info-icon">
                                <i class="fas fa-comments"></i>
                            </div>
                            <div class="info-content">
                                <div class="info-label">Communication Preference</div>
                                <div class="info-value">{{freelancer.communication_preference|default:"N/A"}}</div>
                            </div>
                        </div>
                        <div class="info-item">
                            <div class="info-icon">
                                <i class="fas fa-map-marker-alt"></i>
                            </div>
                            <div class="info-content">
                                <div class="info-label">Location</div>
                                <div class="info-value">{{freelancer.user.city|default:"N/A"}}</div>
                            </div>
                        </div>
                        <div class="info-item">
                            <div class="info-icon">
                                <i class="fas fa-seedling"></i>
                            </div>
                            <div class="info-content">
                                <div class="info-label">Badge</div>
                                <div class="info-value">{{freelancer.badge|default:"N/A"}}</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="sidebar-card">
                    <h3 class="card-title">
                        <i class="fas fa-link"></i> Profile Links
                    </h3>
                    <div class="profile-links">
                        {% if freelancer.github_link %}
                            <a href="{{freelancer.github_link}}" class="link-item" target="_blank">
                                <div class="link-icon github">
                                    <i class="fab fa-github"></i>
                                </div>
                                <div class="link-text">GitHub Profile</div>
                            </a>
                        {% else %}
                            <div class="link-item">
                                <div class="link-icon github">
                                    <i class="fab fa-github"></i>
                                </div>
                                <div class="link-text">GitHub Profile</div>
                            </div>
                        {% endif %}
                        {% if freelancer.linkedin_link %}
                            <a href="{{freelancer.linkedin_link}}" class="link-item" target="_blank">
                                <div class="link-icon linkedin">
                                    <i class="fab fa-linkedin"></i>
                                </div>
                                <div class="link-text">LinkedIn Profile</div>
                            </a>
                        {% else %}
                            <div class="link-item">
                                <div class="link-icon linkedin">
                                    <i class="fab fa-linkedin"></i>
                                </div>
                                <div class="link-text">LinkedIn Profile</div>
                            </div>
                        {% endif %}
                        {% if freelancer.portfolio_link %}
                            <a href="{{freelancer.portfolio_link}}" class="link-item" target="_blank">
                                <div class="link-icon portfolio">
                                    <i class="fas fa-globe"></i>
                                </div>
                                <div class="link-text">Portfolio Website</div>
                            </a>
                        {% else %}
                            <div class="link-item" >
                                <div class="link-icon portfolio">
                                    <i class="fas fa-globe"></i>
                                </div>
                                <div class="link-text">Portfolio Website</div>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block js_files %}
<script src="{% static 'js/home/freelancer-detail.js' %}"></script>
{% endblock %}